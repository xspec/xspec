<?xml version="1.0" encoding="UTF-8"?>
<x:description stylesheet="mirror.xsl" xmlns:mirror="x-urn:test:mirror"
	xmlns:x="http://www.jenitennison.com/xslt/xspec" xmlns:xs="http://www.w3.org/2001/XMLSchema">

	<!--
		Mixture of node and atomic value
	-->

	<x:variable as="item()+" name="multiple-mixed-items" select="node(), 'str', 2">
		<element />
		<x:text>text</x:text>
	</x:variable>
	<x:scenario label="Make sure">
		<x:call function="mirror:false" />
		<x:expect label="the test variable contains a node"
			test="exists($multiple-mixed-items[. instance of node()])" />
		<x:expect label="the test variable contains an atomic value"
			test="exists($multiple-mixed-items[. instance of xs:anyAtomicType])" />
	</x:scenario>

	<x:scenario label="With multiple context items containing both node and atomic value">
		<x:context select="$multiple-mixed-items" />

		<x:scenario label="Calling a named template">
			<x:call template="mirror:context-mirror" />
			<x:expect label="should work" select="$multiple-mixed-items" />
		</x:scenario>

		<x:scenario label="Applying templates">
			<x:context mode="mirror:context-mirror" />
			<x:expect label="should work" select="$multiple-mixed-items" />
		</x:scenario>
	</x:scenario>

	<!--
		Nodes
	-->

	<x:variable as="node()+" name="multiple-nodes">
		<element />
		<x:text>text</x:text>
	</x:variable>
	<x:scenario label="Make sure">
		<x:call function="mirror:false" />
		<x:expect label="the test variable consists of 2+ nodes"
			test="count($multiple-nodes treat as node()+) ge 2" />
	</x:scenario>

	<x:scenario label="With multiple context nodes">
		<x:context select="$multiple-nodes" />

		<x:scenario label="Calling a named template">
			<x:call template="mirror:context-mirror" />
			<x:expect label="should work" select="$multiple-nodes" />
		</x:scenario>

		<x:scenario label="Applying templates">
			<x:context mode="mirror:context-mirror" />
			<x:expect label="should work" select="$multiple-nodes" />
		</x:scenario>
	</x:scenario>

	<!--
		Atomic values
	-->

	<x:variable as="xs:anyAtomicType+" name="multiple-atomic-values" select="'str', 2" />
	<x:scenario label="Make sure">
		<x:call function="mirror:false" />
		<x:expect label="the test variable consists of 2+ atomic values"
			test="count($multiple-atomic-values treat as xs:anyAtomicType+) ge 2" />
	</x:scenario>

	<x:scenario label="With multiple context atomic values">
		<x:context select="$multiple-atomic-values" />

		<x:scenario label="Calling a named template">
			<x:call template="mirror:context-mirror" />
			<x:expect label="should work" select="$multiple-atomic-values" />
		</x:scenario>

		<x:scenario label="Applying templates">
			<x:context mode="mirror:context-mirror" />
			<x:expect label="should work" select="$multiple-atomic-values" />
		</x:scenario>
	</x:scenario>

</x:description>
