<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.jenitennison.com/xslt/xspec"
        xspec="../../tutorial_xproc-testing-demo.xspec"
        xproc="../../../../../tutorial/xproc/demo.xpl"
        date="2000-01-01T00:00:00Z">
   <scenario id="scenario1"
             xspec="../../../../../tutorial/xproc/xproc-testing-demo.xspec">
      <label>Executing eg:demo with a source document, a document having @xml:id, and a wrapper
      element name</label>
      <input-wrap xmlns="">
         <x:call xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                 xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                 xmlns:x="http://www.jenitennison.com/xslt/xspec"
                 step="eg:demo">
            <x:input port="source">
               <doc>Sample document</doc>
            </x:input>
            <x:input port="id-data">
               <element-with-id xml:id="a123"/>
            </x:input>
            <x:option name="wrapper" select="QName('','outermost')"/>
         </x:call>
      </input-wrap>
      <result select="/*">
         <content-wrap xmlns="">
            <pseudo-map xmlns="http://www.jenitennison.com/xslt/xspec">map{"ports":map{"original":map{"document-properties":map{Q{}base-uri:"tutorial_xproc-testing-demo-compiled.xsl",Q{}content-type:"application/xml"},"document":&lt;doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
     xmlns:map="http://www.w3.org/2005/xpath-functions/map"
     xmlns:x="http://www.jenitennison.com/xslt/xspec"&gt;Sample document&lt;/doc&gt;
},"result":map{"document-properties":map{Q{}base-uri:"demo.xpl",Q{}content-type:"application/xml"},"document":&lt;outermost xml:id="a123"&gt;
   &lt;doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
        xmlns:map="http://www.w3.org/2005/xpath-functions/map"
        xmlns:x="http://www.jenitennison.com/xslt/xspec"&gt;Sample document&lt;/doc&gt;
&lt;/outermost&gt;
}}}</pseudo-map>
         </content-wrap>
      </result>
      <test id="scenario1-expect1" successful="true">
         <label>returns the document, wrapped and having the specified ID.</label>
         <port-specific>
            <result select="/self::document-node()">
               <content-wrap xmlns="">
                  <outermost xml:id="a123">
                     <doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                          xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                          xmlns:x="http://www.jenitennison.com/xslt/xspec">Sample document</doc>
                  </outermost>
               </content-wrap>
            </result>
         </port-specific>
         <expect select="/self::document-node()">
            <content-wrap xmlns="">
               <outermost xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                          xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                          xmlns:x="http://www.jenitennison.com/xslt/xspec"
                          xml:id="a123">
                  <doc>Sample document</doc>
               </outermost>
            </content-wrap>
         </expect>
      </test>
      <test id="scenario1-expect2" successful="true">
         <label>The original document is also available at an output port</label>
         <port-specific>
            <result select="/self::document-node()">
               <content-wrap xmlns="">
                  <doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                       xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                       xmlns:x="http://www.jenitennison.com/xslt/xspec">Sample document</doc>
               </content-wrap>
            </result>
         </port-specific>
         <expect select="/self::document-node()">
            <content-wrap xmlns="">
               <doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec">Sample document</doc>
            </content-wrap>
         </expect>
      </test>
      <test id="scenario1-expect3" successful="false">
         <label>and an incorrect expected result appears in the HTML report.</label>
         <port-specific>
            <result select="/self::document-node()">
               <content-wrap xmlns="">
                  <doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                       xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                       xmlns:x="http://www.jenitennison.com/xslt/xspec">Sample document</doc>
               </content-wrap>
            </result>
         </port-specific>
         <expect select="/self::document-node()">
            <content-wrap xmlns="">
               <doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec">Other document</doc>
            </content-wrap>
         </expect>
      </test>
      <test id="scenario1-expect4" successful="true">
         <label>With embedded nodes and no @test, select='/' is optional (XProc only).</label>
         <port-specific>
            <result select="/self::document-node()">
               <content-wrap xmlns="">
                  <outermost xml:id="a123">
                     <doc xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                          xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                          xmlns:x="http://www.jenitennison.com/xslt/xspec">Sample document</doc>
                  </outermost>
               </content-wrap>
            </result>
         </port-specific>
         <expect select="/self::document-node()">
            <content-wrap xmlns="">
               <outermost xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                          xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                          xmlns:x="http://www.jenitennison.com/xslt/xspec"
                          xml:id="a123">
                  <doc>Sample document</doc>
               </outermost>
            </content-wrap>
         </expect>
      </test>
      <test id="scenario1-expect5" successful="true">
         <label>For access to all output ports, omit x:expect/@port.</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:eg="x-urn:tutorial:xproc:xproc-demo"
                      xmlns:map="http://www.w3.org/2005/xpath-functions/map"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="$x:result?ports =&gt; map:keys() =&gt; count()"/>
         </expect-test-wrap>
         <result select="2"/>
         <expect select="2"/>
      </test>
   </scenario>
</report>
