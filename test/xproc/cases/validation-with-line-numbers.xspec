<?xml version="1.0" encoding="UTF-8"?>
<x:description xmlns:cx="http://xmlcalabash.com/ns/extensions" xmlns:p="http://www.w3.org/ns/xproc"
    xmlns:s="x-urn:test:xproc:steplibrary" xmlns:x="http://www.jenitennison.com/xslt/xspec"
    xmlns:xvrl="http://www.xproc.org/ns/xvrl" xproc="library-validation.xpl">

    <!-- See also prefixed-document-parameter.xspec, which relies on prefixes -->
    <x:scenario label="Generate validation report for invalid document">
        <x:call step="s:validate-with-relax-ng">
            <x:input port="schema">
                <p:document href="../../../src/schemas/xspec.rnc"/>
            </x:input>
            <x:option name="assert-valid" select="false()"/>
        </x:call>
        <x:scenario label="Enabling line numbers specified via QName()">
            <x:call>
                <x:input port="source">
                    <p:document href="../compiler-error-cases/p-document-and-x-input-href.xspec"
                        parameters="map{QName('http://xmlcalabash.com/ns/extensions','line-numbering'): true()}"
                    />
                </x:input>
            </x:call>
            <x:expect port="xproc-report" label="xrvl:location includes a line number"
                test="exists(//xvrl:location/@line)"/>
        </x:scenario>
        <x:scenario label="Enabling line numbers specified via URI-qualified name in string">
            <x:call>
                <x:input port="source">
                    <p:document href="../compiler-error-cases/p-document-and-x-input-href.xspec"
                        parameters="map{'Q{http://xmlcalabash.com/ns/extensions}line-numbering': true()}"
                    />
                </x:input>
            </x:call>
            <x:expect port="xproc-report" label="xrvl:location includes a line number"
                test="exists(//xvrl:location/@line)"/>
        </x:scenario>
    </x:scenario>
</x:description>
